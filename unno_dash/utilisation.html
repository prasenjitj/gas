<!DOCTYPE html>
<html>

<head>
  <base target="_top" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js">
  </script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>

  <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.6.1/d3.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <script type="text/javascript" src=" https://cdn.datatables.net/select/1.5.0/js/dataTables.select.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.4.0/js/dataTables.responsive.min.js">
  </script>
  <script type="text/javascript" src="https://cdn.datatables.net/fixedheader/3.3.1/js/dataTables.fixedHeader.min.js">
  </script>
  <script type="text/javascript" src="https://cdn.datatables.net/keytable/2.8.0/js/dataTables.keyTable.min.js"></script>
  <script type="text/javascript"
    src="https://cdn.datatables.net/searchbuilder/1.4.0/js/dataTables.searchBuilder.min.js"></script>
  <script type="text/javascript"
    src="https://cdn.datatables.net/searchbuilder/1.4.0/js/searchBuilder.bootstrap5.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/datetime/1.2.0/js/dataTables.dateTime.min.js"></script>

  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.dataTables.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.4.0/css/responsive.dataTables.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/keytable/2.8.0/css/keyTable.dataTables.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/searchbuilder/1.4.0/css/searchBuilder.bootstrap5.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/datetime/1.2.0/css/dataTables.dateTime.min.css" />

  <!-- amchart.js dependency below this line -->
  <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/xy.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>

  <!-- highchart.js dependency below this line -->
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>
  <script src="https://code.highcharts.com/modules/export-data.js"></script>
  <script src="https://code.highcharts.com/modules/accessibility.js"></script>

  <?!= HtmlService.createHtmlOutputFromFile('stylesheet').getContent(); ?>
</head>

<body>
  <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary mb-3 navbar_menu">
    <div class="container-fluid">
      <a class="navbar-brand" href="http://go/daas-utilisation-dashboard" target="_top"
        title="">go/daas-utilisation-dashboard</a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsingNavbar"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="collapsingNavbar">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <?var url = getScriptUrl();?><a class="nav-link" href="<?=url?>?page=index" target="_top">
              <span class="sr-only">Home</span></a>
          </li>
          <li class="nav-item">
            <?var url = getScriptUrl();?><a class="nav-link" href="<?=url?>?page=table" target="_top">Work
              Status</a>
          </li>
          <li class="nav-item">
            <?var url = getScriptUrl();?><a class="nav-link active" href="<?=url?>?page=utilisation"
              target="_top">Utilisation</a>
          </li>
        </ul>
        <!-- <span class="navbar-text">Date filter:</span>
        <div class="col-xs-3">
          <form class="container-sm">
            <input type="text" class="form-control me-2" name="daterange" value="" />
          </form>
        </div> -->
      </div>
    </div>
  </nav>


  <div class="container">

    <div class="card">
      <div class="card-header">Read informaton below to know how to read this dashboard.</div>
      <div class="card-body">
        <div class="row">
          <p>Bandwidth is calculated as per the tables displayed.</p>
        </div>
        <div class="row">
          <div class="col">
            <div class="table-responsive">
              <table class="table table-hover table-bordered">
                <thead class="table-primary">
                  <tr>
                    <th>Capping</th>
                    <th>Combination</th>
                    <th>Score</th>
                    <th>capacity</th>
                    <th>remaining</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>1 very complex + 1 easy</td>
                    <td>P0S0 + P2S1</td>
                    <td>6.5</td>
                    <td>10</td>
                    <td>3.5</td>
                  </tr>
                  <tr>
                    <td>3 average</td>
                    <td>P1S1</td>
                    <td>6</td>
                    <td>10</td>
                    <td>4.0</td>
                  </tr>
                  <tr>
                    <td>1 complex + 2 average</td>
                    <td>P0S1 + 2 P1S1</td>
                    <td>7.5</td>
                    <td>10</td>
                    <td>2.5</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="col">
            <div class="table-responsive">
              <table class="table table-hover table-bordered">
                <thead class="table-primary">
                  <tr class="">
                    <th>Priority</th>
                    <th>definition</th>
                    <th>Point</th>
                    <th>Severity</th>
                    <th>definition</th>
                    <th>Point</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>P0</td>
                    <td>High</td>
                    <td>2.5</td>
                    <td>S0</td>
                    <td>Complex</td>
                    <td>2.5</td>
                  </tr>
                  <tr>
                    <td>P1</td>
                    <td>Average</td>
                    <td>1</td>
                    <td>S1</td>
                    <td>Average</td>
                    <td>1</td>
                  </tr>
                  <tr>
                    <td>P2</td>
                    <td>Low</td>
                    <td>0.5</td>
                    <td>S2</td>
                    <td>easy</td>
                    <td>0.5</td>
                  </tr>
                  <tr>
                    <td>P3</td>
                    <td>Very low</td>
                    <td>0.25</td>
                    <td>S3</td>
                    <td>very easy</td>
                    <td>0.25</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="overlay" style="display:none;">
    <div class="spinner"></div>
    <br/>
    Loading...
  </div>

  <div class="container">
    <!--  style="width: 40rem" -->
    <div class="row">
      <div class="col">
        <div class="card">
          <!-- <div class="card-header">Ldap Utilisation Distribution</div> -->
          <div class="card-body">
            <div id="ldapdistchart"></div>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card">
          <!-- <div class="card-header">Team utilisation</div> -->
          <div class="card-body">
            <div id="teampiechart"></div>
          </div>
        </div>
      </div>

    </div>

    <div class="row">
      <div class="col-md-6">
        <div class="card">
          <!-- <div class="card-header">Utilisation per resource</div> -->
          <div class="card-body">
            <div id="piechart"></div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card">
          <!-- <div class="card-header">Utilisation per resource</div> -->
          <div class="card-body">
            <div id="achart"></div>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card">
          <!-- <div class="card-header">Bandwidth per resource</div> -->
          <div class="card-body">
            <div id="barchart"></div>
          </div>
        </div>
      </div>


    </div>

    <div class="row">

      <div class="col-md-6">
        <div class="card" style="height: 34rem">
          <!-- <div class="card-header">Pivot by bandwidth percentage</div> -->
          <div class="card-body">
            <div id="bwtrendchart"></div>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card">
          <div class="card-header">Bandwidth Table</div>
          <div class="card-body">
            <table id="data-table-capacity" class="table table-sm table-hover table-bordered compact display"
              style="width:100%">
              <thead class="table-primary">
                <tr>
                  <th>ldap</th>
                  <th>Utilization (calculated)</th>
                  <th>Bandwidth (calculated)</th>
                  <th>Bandwidth (self)</th>
                  <th>Primary score</th>
                  <th>Secondary score</th>
                  <th>Reviewer score</th>
                  <th>Mentor score</th>
                </tr>
              </thead>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md">
        <div class="card">
          <div class="card-header">Assignment Summary</div>
          <div class="card-body">
            <table id="data-table-assignments"
              class="table table-sm table-hover table-bordered compact collapsed display" style="width:100%">
              <thead class="table-primary">
                <tr>
                  <th>ldap</th>
                  <th>Assignee</th>
                  <th>Primary</th>
                  <th>Secondary</th>
                  <th>Reviewer</th>
                  <th>Mentor</th>
                </tr>
              </thead>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md">
        <div class="card">
          <div class="card-header">Buganizer Data</div>
          <div class="card-body">
            <table id="data-table-buganizer" class="table table-sm table-hover table-bordered compact collapsed display"
              style="width:100%">
              <thead class="table-primary">
                <tr>
                  <th>Title</th>
                  <th>Id</th>
                  <th>Assignee</th>
                  <th>Primary</th>
                  <th>Secondary</th>
                  <th>Reviewer</th>
                  <th>Project Status</th>
                  <th>Status</th>
                  <th>Target Date</th>
                  <th>Agent ETA</th>
                  <th>Priority</th>
                  <th>Severity</th>
                  <th>Last comment</th>
                  <th>Mentor</th>
                </tr>
              </thead>
            </table>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- <?!= HtmlService.createHtmlOutputFromFile('javascript').getContent(); ?> -->
  <?!= HtmlService.createHtmlOutputFromFile('utscript').getContent(); ?>
</body>

</html>